{"version":3,"file":"wd-floating-panel.js","sources":["node_modules/wot-design-uni/components/wd-floating-panel/wd-floating-panel.vue","../../../software/011-HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY29kZS9zbWFydC10cmFmZmljL3NtYXJ0LXRyYWZmaWMtbWluaS1wcm9ncmFtcy9ub2RlX21vZHVsZXMvd290LWRlc2lnbi11bmkvY29tcG9uZW50cy93ZC1mbG9hdGluZy1wYW5lbC93ZC1mbG9hdGluZy1wYW5lbC52dWU"],"sourcesContent":["<template>\n  <view\n    :class=\"`wd-floating-panel ${customClass} ${safeAreaInsetBottom ? 'is-safe' : ''}`\"\n    :style=\"rootStyle\"\n    @touchstart.passive=\"handleTouchStart\"\n    @touchmove.passive=\"handleTouchMove\"\n    @touchend=\"handleTouchEnd\"\n    @touchcancel=\"handleTouchEnd\"\n  >\n    <view :class=\"`wd-floating-panel__header`\">\n      <view :class=\"`wd-floating-panel__header-bar`\"></view>\n    </view>\n\n    <scroll-view\n      :class=\"`wd-floating-panel__content`\"\n      data-id=\"content\"\n      :show-scrollbar=\"showScrollbar\"\n      scroll-y\n      @touchmove.stop.prevent=\"handleTouchMove\"\n    >\n      <slot />\n    </scroll-view>\n  </view>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  name: 'wd-floating-panel',\n  options: {\n    virtualHost: true,\n    addGlobalClass: true,\n    styleIsolation: 'shared'\n  }\n}\n</script>\n\n<script lang=\"ts\" setup>\nimport { computed, onBeforeMount, ref, watch, type CSSProperties } from 'vue'\nimport { floatingPanelProps } from './type'\nimport { addUnit, closest, objToStyle } from '../common/util'\nimport { useTouch } from '../composables/useTouch'\n\nconst touch = useTouch()\n\nconst props = defineProps(floatingPanelProps)\nconst emit = defineEmits(['update:height', 'height-change'])\n\nconst heightValue = ref<number>(props.height)\n\nconst DAMP = 0.2 // 阻尼系数\nlet startY: number // 起始位置\nconst windowHeight = ref<number>(0)\nconst dragging = ref<boolean>(false) // 是否正在拖拽\n\nconst boundary = computed(() => ({\n  min: props.anchors[0] ? props.anchors[0] : 100,\n  max: props.anchors[props.anchors.length - 1] ? props.anchors[props.anchors.length - 1] : Math.round(windowHeight.value * 0.6)\n}))\n\nconst anchors = computed(() => (props.anchors.length >= 2 ? props.anchors : [boundary.value.min, boundary.value.max]))\n\nconst rootStyle = computed(() => {\n  const style: CSSProperties = {\n    height: addUnit(boundary.value.max),\n    transform: `translateY(calc(100% + ${addUnit(-heightValue.value)}))`,\n    transition: !dragging.value ? `transform ${props.duration}ms cubic-bezier(0.18, 0.89, 0.32, 1.28)` : 'none'\n  }\n\n  return `${objToStyle(style)};${props.customStyle}`\n})\n\nconst updateHeight = (value: number) => {\n  heightValue.value = value\n  emit('update:height', value)\n}\n\nconst handleTouchStart = (event: TouchEvent) => {\n  touch.touchStart(event)\n  dragging.value = true\n  startY = -heightValue.value\n}\n\nconst handleTouchMove = (event: TouchEvent) => {\n  const target = event.currentTarget as any\n  if (target.dataset.id == 'content') {\n    if (!props.contentDraggable) return\n  }\n  touch.touchMove(event)\n  const moveY = touch.deltaY.value + startY\n  updateHeight(-ease(moveY))\n}\n\nconst handleTouchEnd = () => {\n  dragging.value = false\n  updateHeight(closest(anchors.value, heightValue.value))\n\n  if (heightValue.value !== -startY) {\n    emit('height-change', { height: heightValue.value })\n  }\n}\n\nconst ease = (y: number) => {\n  const absDistance = Math.abs(y)\n  const { min, max } = boundary.value\n\n  if (absDistance > max) {\n    return -(max + (absDistance - max) * DAMP)\n  }\n\n  if (absDistance < min) {\n    return -(min - (min - absDistance) * DAMP)\n  }\n\n  return y\n}\n\nwatch(\n  () => props.height,\n  (value) => {\n    heightValue.value = value\n  }\n)\n\nwatch(\n  boundary,\n  () => {\n    updateHeight(closest(anchors.value, heightValue.value))\n  },\n  { immediate: true }\n)\n\nonBeforeMount(() => {\n  const { windowHeight: _windowHeight } = uni.getSystemInfoSync()\n  windowHeight.value = _windowHeight\n})\n</script>\n\n<style lang=\"scss\" scoped>\n@import './index.scss';\n</style>\n","import Component from 'D:/code/smart-traffic/smart-traffic-mini-programs/node_modules/wot-design-uni/components/wd-floating-panel/wd-floating-panel.vue'\nwx.createComponent(Component)"],"names":["useTouch","ref","computed","addUnit","objToStyle","closest","watch","onBeforeMount","uni"],"mappings":"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","x_google_ignoreList":[0]}