{"version":3,"file":"index.js","sources":["pages/bus/index.vue","../../../software/011-HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYnVzL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\r\n  <map\r\n    style=\"width: 100vw; height: 100vh\"\r\n    :zIndex=\"10\"\r\n    :latitude=\"userLatitude\"\r\n    :longitude=\"userLongitude\"\r\n    :markers=\"markers\"\r\n    :show-location=\"true\"\r\n  ></map>\r\n  <wd-floating-panel\r\n    style=\"z-index: 100\"\r\n    v-model:height=\"height\"\r\n    :anchors=\"anchors\"\r\n    @heightChange=\"handleHeightChange\"\r\n  >\r\n    <view class=\"bus-search-container\">\r\n      <view class=\"search-header\">\r\n        <view class=\"title\">公交查询</view>\r\n        <view class=\"search-box\">\r\n          <input type=\"text\" placeholder=\"搜索公交线路\" v-model=\"searchText\" />\r\n          <button class=\"search-btn\" @tap=\"searchBus\">搜索</button>\r\n        </view>\r\n      </view>\r\n\r\n      <view class=\"bus-list\" v-if=\"busRoutes.length > 0\">\r\n        <view class=\"list-title\">线路列表</view>\r\n        <view\r\n          class=\"bus-item\"\r\n          v-for=\"(route, index) in busRoutes\"\r\n          :key=\"index\"\r\n          @tap=\"selectRoute(route)\"\r\n        >\r\n          <view class=\"bus-number\">{{ route.number }}</view>\r\n          <view class=\"bus-info\">\r\n            <view class=\"bus-route\"\r\n              >{{ route.startStation }} - {{ route.endStation }}</view\r\n            >\r\n            <view class=\"bus-time\"\r\n              >{{ route.startTime }} - {{ route.endTime }}</view\r\n            >\r\n          </view>\r\n          <view class=\"bus-price\">¥{{ route.price }}</view>\r\n        </view>\r\n      </view>\r\n\r\n      <view class=\"history-search\" v-else>\r\n        <view class=\"list-title\">历史查询</view>\r\n        <view\r\n          class=\"history-item\"\r\n          v-for=\"(item, index) in historySearches\"\r\n          :key=\"index\"\r\n          @tap=\"useHistory(item)\"\r\n        >\r\n          <view class=\"history-text\">{{ item }}</view>\r\n          <view class=\"history-delete\" @tap.stop=\"removeHistory(index)\">×</view>\r\n        </view>\r\n        <view class=\"empty-history\" v-if=\"historySearches.length === 0\">\r\n          暂无历史查询记录\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </wd-floating-panel>\r\n</template>\r\n<script setup>\r\nimport { ref } from \"vue\";\r\nimport { onLoad } from \"@dcloudio/uni-app\";\r\nconst height = ref(0);\r\nconst windowHeight = ref(0);\r\nconst anchors = ref([]);\r\n\r\nconst handleHeightChange = ({ height }) => {\r\n  console.log(height);\r\n};\r\nconst userLongitude = ref('116.95');\r\nconst userLatitude = ref('35.59');\r\nconst markers = ref([]);\r\n\r\n// 添加公交查询相关数据\r\nconst searchText = ref(\"\");\r\nconst busRoutes = ref([\r\n  {\r\n    number: \"1路\",\r\n    startStation: \"火车站\",\r\n    endStation: \"曲师大\",\r\n    startTime: \"06:00\",\r\n    endTime: \"22:00\",\r\n    price: \"2.00\",\r\n  },\r\n  {\r\n    number: \"2路\",\r\n    startStation: \"曲师大\",\r\n    endStation: \"高铁站\",\r\n    startTime: \"05:30\",\r\n    endTime: \"23:00\",\r\n    price: \"2.00\",\r\n  },\r\n  // {\r\n  //   number: \"32路\",\r\n  //   startStation: \"南山区\",\r\n  //   endStation: \"科技园\",\r\n  //   startTime: \"06:30\",\r\n  //   endTime: \"21:30\",\r\n  //   price: \"2.00\",\r\n  // },\r\n  // {\r\n  //   number: \"301路\",\r\n  //   startStation: \"机场\",\r\n  //   endStation: \"市中心\",\r\n  //   startTime: \"05:00\",\r\n  //   endTime: \"24:00\",\r\n  //   price: \"3.50\",\r\n  // },\r\n]);\r\n\r\nconst historySearches = ref([\"1路\", \"地铁2号线\", \"301路快线\"]);\r\n\r\n// 公交查询相关方法\r\nconst searchBus = () => {\r\n  if (!searchText.value.trim()) return;\r\n  // 模拟搜索功能，实际项目中应调用API\r\n  console.log(\"搜索:\", searchText.value);\r\n\r\n  // 添加到历史记录\r\n  if (!historySearches.value.includes(searchText.value)) {\r\n    historySearches.value.unshift(searchText.value);\r\n    if (historySearches.value.length > 10) {\r\n      historySearches.value.pop();\r\n    }\r\n  }\r\n\r\n  searchText.value = \"\";\r\n};\r\n\r\nconst selectRoute = (route) => {\r\n  console.log(\"选择线路:\", route);\r\n  // 这里可以实现路线详情展示或在地图上显示路线\r\n};\r\n\r\nconst useHistory = (text) => {\r\n  searchText.value = text;\r\n  searchBus();\r\n};\r\n\r\nconst removeHistory = (index) => {\r\n  historySearches.value.splice(index, 1);\r\n};\r\n\r\n// function getLocation() {\r\n//   uni.authorize({\r\n//     scope: \"scope.userLocation\",\r\n//     success() {\r\n//       uni.getLocation({\r\n//         type: \"gcj02\",\r\n//         success: (res) => {\r\n//           userLatitude.value = res.latitude;\r\n//           userLongitude.value = res.longitude;\r\n//         },\r\n//       });\r\n//     },\r\n//   });\r\n// }\r\n\r\nonLoad(() => {\r\n  // getLocation();\r\n  windowHeight.value = uni.getSystemInfoSync().windowHeight;\r\n  anchors.value = [\r\n    100,\r\n    Math.round(0.4 * windowHeight.value),\r\n    Math.round(0.7 * windowHeight.value),\r\n  ];\r\n  height.value = anchors.value[1];\r\n});\r\n</script>\r\n<style scoped>\r\n.bus-search-container {\r\n  padding: 15px;\r\n  box-sizing: border-box;\r\n  height: 100%;\r\n  background-color: #fff;\r\n}\r\n\r\n.search-header {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.title {\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.search-box {\r\n  display: flex;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 5px;\r\n  overflow: hidden;\r\n}\r\n\r\n.search-box input {\r\n  flex: 1;\r\n  height: 40px;\r\n  padding: 0 10px;\r\n  border: none;\r\n}\r\n\r\n.search-btn {\r\n  width: 80px;\r\n  height: 40px;\r\n  background-color: #2196f3;\r\n  color: white;\r\n  border: none;\r\n  font-size: 14px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 0;\r\n}\r\n\r\n.list-title {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  margin: 15px 0 10px 0;\r\n  color: #333;\r\n}\r\n\r\n.bus-item {\r\n  display: flex;\r\n  padding: 15px 10px;\r\n  border-bottom: 1px solid #f0f0f0;\r\n  align-items: center;\r\n}\r\n\r\n.bus-number {\r\n  width: 60px;\r\n  height: 30px;\r\n  background-color: #2196f3;\r\n  color: white;\r\n  border-radius: 4px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-right: 15px;\r\n  font-weight: bold;\r\n}\r\n\r\n.bus-info {\r\n  flex: 1;\r\n}\r\n\r\n.bus-route {\r\n  font-size: 15px;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.bus-time {\r\n  font-size: 12px;\r\n  color: #888;\r\n}\r\n\r\n.bus-price {\r\n  color: #ff6b6b;\r\n  font-weight: bold;\r\n}\r\n\r\n.history-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 12px 5px;\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.history-text {\r\n  color: #555;\r\n}\r\n\r\n.history-delete {\r\n  width: 20px;\r\n  height: 20px;\r\n  color: #999;\r\n  font-size: 16px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.empty-history {\r\n  text-align: center;\r\n  color: #999;\r\n  padding: 30px 0;\r\n  font-size: 14px;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/code/smart-traffic/smart-traffic-mini-programs/pages/bus/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","height","uni","onLoad"],"mappings":";;;;;;;;;;;;;AAkEA,UAAM,SAASA,cAAAA,IAAI,CAAC;AACpB,UAAM,eAAeA,cAAAA,IAAI,CAAC;AAC1B,UAAM,UAAUA,cAAAA,IAAI,CAAA,CAAE;AAEtB,UAAM,qBAAqB,CAAC,EAAE,QAAAC,cAAa;AACzCC,oBAAAA,MAAY,MAAA,OAAA,6BAAAD,OAAM;AAAA,IACpB;AACA,UAAM,gBAAgBD,cAAAA,IAAI,QAAQ;AAClC,UAAM,eAAeA,cAAAA,IAAI,OAAO;AAChC,UAAM,UAAUA,cAAAA,IAAI,CAAA,CAAE;AAGtB,UAAM,aAAaA,cAAAA,IAAI,EAAE;AACzB,UAAM,YAAYA,cAAAA,IAAI;AAAA,MACpB;AAAA,QACE,QAAQ;AAAA,QACR,cAAc;AAAA,QACd,YAAY;AAAA,QACZ,WAAW;AAAA,QACX,SAAS;AAAA,QACT,OAAO;AAAA,MACR;AAAA,MACD;AAAA,QACE,QAAQ;AAAA,QACR,cAAc;AAAA,QACd,YAAY;AAAA,QACZ,WAAW;AAAA,QACX,SAAS;AAAA,QACT,OAAO;AAAA,MACR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAiBH,CAAC;AAED,UAAM,kBAAkBA,cAAG,IAAC,CAAC,MAAM,SAAS,QAAQ,CAAC;AAGrD,UAAM,YAAY,MAAM;AACtB,UAAI,CAAC,WAAW,MAAM,KAAM;AAAE;AAE9BE,oBAAY,MAAA,MAAA,OAAA,8BAAA,OAAO,WAAW,KAAK;AAGnC,UAAI,CAAC,gBAAgB,MAAM,SAAS,WAAW,KAAK,GAAG;AACrD,wBAAgB,MAAM,QAAQ,WAAW,KAAK;AAC9C,YAAI,gBAAgB,MAAM,SAAS,IAAI;AACrC,0BAAgB,MAAM;QACvB;AAAA,MACF;AAED,iBAAW,QAAQ;AAAA,IACrB;AAEA,UAAM,cAAc,CAAC,UAAU;AAC7BA,oBAAY,MAAA,MAAA,OAAA,8BAAA,SAAS,KAAK;AAAA,IAE5B;AAEA,UAAM,aAAa,CAAC,SAAS;AAC3B,iBAAW,QAAQ;AACnB;IACF;AAEA,UAAM,gBAAgB,CAAC,UAAU;AAC/B,sBAAgB,MAAM,OAAO,OAAO,CAAC;AAAA,IACvC;AAiBAC,kBAAAA,OAAO,MAAM;AAEX,mBAAa,QAAQD,cAAAA,MAAI,kBAAiB,EAAG;AAC7C,cAAQ,QAAQ;AAAA,QACd;AAAA,QACA,KAAK,MAAM,MAAM,aAAa,KAAK;AAAA,QACnC,KAAK,MAAM,MAAM,aAAa,KAAK;AAAA,MACvC;AACE,aAAO,QAAQ,QAAQ,MAAM,CAAC;AAAA,IAChC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1KD,GAAG,WAAW,eAAe;"}